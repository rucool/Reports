---
title: "RUCOOL August 2025 Budget Report"
format: revealjs
editor: visual
---

```{r}
library(knitr)
library(tidyverse)
library(kableExtra)
library(dplyr)
library(gt)
library(lubridate)
library(readxl)

pb <- read_excel("Downloads/July 2025Projects Consolidated View By Task(4).xlsx", skip=3)
pb = filter(pb, `Current Project Status Name` %in% "Active") 
pb$`Sponsor End Date` = as.POSIXct(pb$`Sponsor End Date`, format = "%m/%d/%Y")
pb = arrange(pb, `Sponsor End Date`)
pb = dplyr::select(pb, -`...13`)

difftime_func <- function(n){
    difftime(strptime(pb$`Sponsor End Date`[n], format = "%Y-%m-%d"), 
             + strptime("2025-08-05", format = "%Y-%m-%d"), 
             units="days")
  }
```

## Ended 7/31 but still active

## MARACOOS

```{r}
n=c(1:6)
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

Glider (Aug/Sept), Mike (Jan), Satellite (June - Steve will bring to zero), HFR (Nov or Feb), Modeling, Data to Model (Smith), DAC

```{r}
n=c(1:6)
difftime_func(n)

kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 10)
```

## NOAA Glider Training

```{r}
n=7
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

No one charge to it until Mike says

```{r}
n=7
difftime_func(n)

kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 15)
```

## Under 3 months

to Nov. 2025

## Hurricane Supp.

```{r}
n=9
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

\$70k coming for new account. Mike charging 20%, could add another glider person in Aug.

```{r}
n=9
difftime_func(n)
kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 15)
```

## UVI

```{r}
n=10
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent.

Brian and Jess can charge this out.

```{r}
n=10
difftime_func(n)
kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 15)
```

## Ramboll

```{r}
n=11
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

Stopwork order. Daphne summer and then the remainder goes back.

```{r}
n=11
difftime_func(n)
kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 15)
```

## BPU Wind

```{r}
n=12
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

Fernando 60%, Mike 10%, Julia 100% until Aug. 31. Summer still needs to be posted. Will revisit end of July.

```{r}
n=12
difftime_func(n)
kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 15)
```

## SOCCOM

```{r}
n=c(8,13)
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

SOCCOM 2: Need to charge another month of Oscar, summer for Quentin, Mya, and Teemer.

SOCCOM 3: Year 1 of 4

```{r}
n=c(8,13)
difftime_func(n)
kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 13) 
```

## Arete

```{r}
n=14
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

```{r}
n=14
difftime_func(n)
kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 15)
```

# SNJ-DEP Ecoglider Phase 1

```{r}
n=15
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

100% Delphine, 65% Lori, 60% Jess, 70% Brian charging. Jake salary, fall salary and tuition for Sam, Ashley, and Izzy tuition, Lauren summer. Still more to spend (\~\$60-70k)

```{r}
n=15
difftime_func(n)
kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 15)
```

## Cod

User fees need to be taken out (\$15k). Jasco still needs to send final invoice for SRW \~\$33k (sent it for REV already). Steve split the Jasco invoices between REV and SRW, and should already be moved (Steve will check).

```{r}
n=c(16)
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

```{r}
n=c(16)
difftime_func(n)
kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 15)
```

## SNJ-DEP RMI Ocean Observing

```{r}
n=17
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

All for subcontracts (\~\$53k)

```{r}
n=17
difftime_func(n)
kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 15)
```

## Under 6 months

to Feb. 2026

## Seaforestation

```{r}
n=18
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

Charge Aug. for Oscar (\~45k), travel, Jess 40% salary, Joe glider camp. User fee still needs to be charged (\$20k)

```{r}
n=18
difftime_func(n)
kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 15)
```

## Orsted Data Archive

\$120k, ends 12/31 Nothing spent

Will move Chase and maybe Joey and Andre onto this

## WAP UConn

```{r}
n=19
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

Mostly students (Teemer, Myam Quintin) and people we send to Antarctica. Account was set up late

```{r}
n=19
difftime_func(n)
kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 15)
```

## Tufts

```{r}
n=21
x = format((pb$`Total Actual Cost`[n]/pb$Budget[n])*100, digits = 2)
```

`r x`% spent

```{r}
n=21
difftime_func(n)
kable(pb[n,], format.args = list(big.mark = ",")) %>%
  kable_styling(font_size = 15)
```
